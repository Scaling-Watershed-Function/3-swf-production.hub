mutate(frst = if_else(tot_loc!=100.00,frst*(100/tot_loc),frst)) %>%
mutate(shrb = if_else(tot_loc!=100.00,shrb*(100/tot_loc),shrb)) %>%
mutate(urbn = if_else(tot_loc!=100.00,urbn*(100/tot_loc),urbn)) %>%
mutate(wtnd = if_else(tot_loc!=100.00,wtnd*(100/tot_loc),wtnd)) %>%
mutate(tot_loc = if_else(tot_loc!=100.00,agrc+frst+shrb+urbn+wtnd,tot_loc)) %>%
mutate(agrc_t = if_else(tot_acm!=100.00,agrc_t*(100/tot_acm),agrc_t)) %>%
mutate(frst_t = if_else(tot_acm!=100.00,frst_t*(100/tot_acm),frst_t)) %>%
mutate(shrb_t = if_else(tot_acm!=100.00,shrb_t*(100/tot_acm),shrb_t)) %>%
mutate(urbn_t = if_else(tot_acm!=100.00,urbn_t*(100/tot_acm),urbn_t)) %>%
mutate(wtnd_t = if_else(tot_acm!=100.00,wtnd_t*(100/tot_acm),wtnd_t)) %>%
mutate(tot_acm = if_else(tot_acm!=100.00,agrc_t+frst_t+shrb_t+urbn_t+wtnd_t,tot_acm))
# By checking again with summary(lndf), we verify that all land cover uses add to 100%
# At least for areas that had above 75% of land categorized by the uses selected by
# Son et al., 2022.
summary(yrb_wlm_lndf)
###############################################################################
# Scaling Analysis for Respiration Rates across the Yakima and Willamette River
# Basins
# DATA PREPARATION
###############################################################################
# RESPIRATION DATA
###############################################################################
#By : Francisco Guerrero
#Data source: SWAT-NEXXS Model simulations (By Kyongho Son)
#Loading packages:
# Run for the first time only
#install.packages("librarian")
#To run this code in macOS it is necessary to install XQuartz from
#www.xquartz.org
librarian::shelf(tidyverse, GGally) #it searches for the packages in your library,
#if you don't have them installed, it will proceed with the installation and it
#will bring them into your work space (like library will commonly do).
set.seed(2703)
# Data:
# Commit test
#values
#Yakima River Basin (yrb)
yrb_lgc_o <- read.csv("assets/data/raw/220725_yrb_resp_vars_legacy.csv",
stringsAsFactors = TRUE) #Dataset used for the AGU poster with uncorrected cumulative values
#i.e. respiration rates were not normalized by watershed area)
yrb_spt_o <- read.csv("assets/data/raw/230110_yrb_spatial_camp.csv",
stringsAsFactors = TRUE) #Predicted respiration rates at field locations
yrb_rsp_o <- read.csv("assets/data/raw/230116_yrb_respt_vars.csv",
stringsAsFactors = TRUE) #Updated dataset with corrected cumulative values
yrb_hbc_o <- read.csv("assets/data/raw/230117_yrb_hbgc_vars.csv",
stringsAsFactors = TRUE) #Hydro-biogeochemical variables (including residence
#time and hyporheic exchange)
#Willamette River Basin (wlm)
#that would be merged under the labels "rsp" or "hbc".
wlm_rsp_o <- read.csv("assets/data/raw/cum_resp_WM_mass_data_0116_2023.csv",
stringsAsFactors = TRUE)
wlm_rsp_i <- read.csv("assets/data/raw/model_resp_wm_rf0116.csv", stringsAsFactors = TRUE)
wlm_hbc_o <- read.csv("assets/data/raw/nhd_WM_streamdatabase_annual_resp_mass_01162023.csv",
stringsAsFactors = TRUE)
wlm_hbc_i <- read.csv("assets/data/raw/model_resp_annual_wm_input_output_df_01_16_2023.csv",
stringsAsFactors = TRUE)
var_names <- colnames(yrb_rsp_o)
# [1] "COMID"                       "FromNode"                    "ToNode"                      "Hydrosq"
# [5] "CAT_STREAM_LENGTH"           "CAT_STREAM_SLOPE"            "TOT_STREAM_LENGTH"           "TOT_STREAM_SLOPE"
# [9] "CAT_BASIN_AREA"              "TOT_BASIN_AREA"              "pred_stream_area_m2_fill"    "pred_logw_m"
# [13] "stream_length_m"             "cum_totco2g_day"             "cum_stream_area_m2"          "cum_stream_length_m"
# [17] "cum_totco2g_day_Tsurface_m2" "cum_totco2g_day_Tdrain_m2"
#Second, we need to identify where these variables are stored withing the WLM
#datasets
glimpse(wlm_rsp_o)
glimpse(wlm_rsp_i)
glimpse(wlm_hbc_o)
glimpse(wlm_hbc_i)
wlm_hbc_om <- dplyr::select(wlm_hbc_o,COMID,CAT_STREAM_SLOPE,TOT_STREAM_SLOPE,TOT_BASIN_AREA)
wlm_hbc_im <- dplyr::select(wlm_hbc_i,COMID,TotDASqKM,length_m)
wlm_rsp_om <- dplyr::select(wlm_rsp_o,COMID,FromNode,ToNode,cum_totco2g_day,cum_stream_area_m2,
cum_stream_length_m, cum_totco2g_day_Tdrain_m2, cum_totco2g_day_Tsurface_m2)
wlm_rsp_im <- dplyr::select(wlm_rsp_i,COMID,totco2g_day_fill,pred_stream_area_m2_fill,stream_length_m)
#Since merge only takes two inputs at a time, we have to merge our data sets sequentially
wlm_hbc_mg <- unique(merge(wlm_hbc_om,wlm_hbc_im,by = "COMID"))
wlm_rsp_mg <- unique(merge(wlm_rsp_om,wlm_rsp_im,by = "COMID"))
wlm_rsp_mg0 <- unique(merge(wlm_rsp_mg,wlm_hbc_mg,by="COMID"))
wlm_rsp_mg0$pred_logw_m <- log((wlm_rsp_mg0$pred_stream_area_m2_fill/wlm_rsp_mg0$stream_length_m),10)
#We will now reorganize columns to bind the YRM and WLM datasets
yrb_rsp_m1 <- dplyr::select(yrb_rsp_o,
COMID,
FromNode,
ToNode,
TOT_BASIN_AREA,
stream_length_m,
pred_logw_m,
pred_stream_area_m2_fill,
cum_stream_length_m,
cum_stream_area_m2,
cum_totco2g_day,
cum_totco2g_day_Tsurface_m2,
cum_totco2g_day_Tdrain_m2)
wlm_rsp_m1 <- dplyr::select(wlm_rsp_mg0,
COMID,
FromNode,
ToNode,
TOT_BASIN_AREA,
stream_length_m,
pred_logw_m,
pred_stream_area_m2_fill,
cum_stream_length_m,
cum_stream_area_m2,
cum_totco2g_day,
cum_totco2g_day_Tsurface_m2,
cum_totco2g_day_Tdrain_m2)
yrb_rsp_m1$basin <- "Yakima"
wlm_rsp_m1$basin <- "Willamette"
yrb_hbc_m1 <- select(yrb_hbc_o,
COMID,
StreamOrde,
logQ_m3_div_s,
logwbkf_m,
logd_m,
logdbkf_m,
D50_m,
pred_annual_DOC,
pred_annual_DO,
no3_conc_mg_l,
logRT_total_hz_s,
logq_hz_total_m_s)
wlm_hbc_m1 <- select(wlm_hbc_i,
COMID,
StreamOrde,
logQ_m3_div_s,
logwbkf_m,
logd_m,
logdbkf_m,
D50_m,
pred_annual_DOC,
pred_annual_DO,
no3_conc_mg_l,
logRT_total_hz_s,
logq_hz_total_m_s)
yrb_rsp_m2 <- unique(merge(yrb_rsp_m1,yrb_hbc_m1,by = "COMID"))
wlm_rsp_m2 <- unique(merge(wlm_rsp_m1,wlm_hbc_m1,by = "COMID"))
yrb_wlm_rsp <- rbind(yrb_rsp_m2,wlm_rsp_m2)
#Test plot
p0 <- ggplot(yrb_wlm_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day_Tdrain_m2,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
geom_abline(slope = 1, intercept =-3,linetype = "solid")+
geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)
p0
glimpse(yrb_wlm_rsp)
p0 <- ggplot(yrb_wlm_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
geom_abline(slope = 1, intercept =-3,linetype = "solid")+
geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)
p0
p0 <- ggplot(yrb_wlm_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)
p0
p0 <- ggplot(yrb_wlm_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, iintercept = 2.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)
p0
p0 <- ggplot(yrb_wlm_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)
p0
p0 <- ggplot(yrb_wlm_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)+
ggtitle("Total Cumulative Respiration per Day")
p0
glimpse(yrb_wlm_rsp)
p0 <- ggplot(yrb_wlm_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day_Tsurface_m2,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)+
ggtitle("Total Cumulative Respiration per Day")
p0
p0 <- ggplot(yrb_wlm_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day_Tsurface_m2,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Stream Surface")
p0
p0 <- ggplot(yrb_wlm_rsp,aes(cum_stream_area_m2,cum_totco2g_day_Tsurface_m2,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Stream Surface")
p0
nrow(na.omit(yrb_wlm_rsp))
nrow(yrb_wlm_rsp)
p0 <- ggplot(na.omit(yrb_wlm_rsp),aes(cum_stream_area_m2,cum_totco2g_day_Tsurface_m2,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Stream Surface")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(cum_stream_area_m2,
cum_totco2g_day_Tsurface_m2))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(cum_stream_area_m2,
cum_totco2g_day_Tsurface_m2,
color = basin))+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Stream Surface")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(cum_stream_area_m2,
cum_totco2g_day_Tsurface_m2))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(cum_stream_area_m2,
cum_totco2g_day_Tsurface_m2,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Stream Surface")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tsurface_m2))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(cum_stream_area_m2,
cum_totco2g_day_Tsurface_m2,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Stream Surface")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tsurface_m2))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tsurface_m2,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Stream Surface")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(TOT_BASIN_AREA,
cum_totco2g_day))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(TOT_BASIN_AREA,
cum_totco2g_day,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(TOT_BASIN_AREA,
cum_totco2g_day))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(TOT_BASIN_AREA,
cum_totco2g_day,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tdrain_m2))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tdrain_m2,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 1.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tdrain_m2))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tdrain_m2,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -2.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(TOT_BASIN_AREA,
cum_totco2g_day/TOT_BASIN_AREA))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(TOT_BASIN_AREA,
cum_totco2g_day/TOT_BASIN_AREA,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -2.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Watershed Area")
p0
p0 <- ggplot(yrb_wlm_rsp,
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tdrain_m2))+
geom_point(alpha = 0.35, color = "gray")+
geom_point(data = na.omit(yrb_wlm_rsp),
aes(TOT_BASIN_AREA,
cum_totco2g_day_Tdrain_m2,
color = basin),
alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = -2.5)+
# geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
# geom_abline(slope = 1, intercept =-3,linetype = "solid")+
# geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin,
ncol = 2)+
ggtitle("Total Cumulative Respiration per Day per Square Meter of Watershed Area")
p0
yrb_wlm_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_smooth(method = "lm")+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
yrb_wlm_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_smooth(method = "lm")+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(variable~basin,ncol = 2)
yrb_wlm_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
# geom_smooth(method = "lm")+
geom_hex()+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(variable~basin,ncol = 2)
yrb_wlm_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable, fill = variable))+
# geom_smooth(method = "lm")+
geom_hex()+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(variable~basin,ncol = 2)
yrb_wlm_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable, fill = variable))+
# geom_smooth(method = "lm")+
# geom_hex()+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(variable~basin,ncol = 2)
yrb_wlm_rsp %>% na.omit(yrb_wlm_rsp) %>% select(COMID,
basin,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 8:12,
aes(color = basin ,alpha = 0.05))
