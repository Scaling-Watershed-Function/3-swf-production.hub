glimpse(yrb_rsp_o)
glimpse(yrb_hbc_o)
p3 <- ggplot(yrb_rsp_o,aes(TOT_BASIN_AREA,cum_totco2g_day_Tsurface_m2))+
geom_point()+
scale_x_log10()+
scale_y_log10()
p3
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 50, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 10, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 1.5, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 1.75, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.25, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.75, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 3.25, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.5)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.005)+
geom_smooth(method = "lm", se = FALSE)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.05)+
geom_smooth(method = "lm", se = FALSE)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.01)+
geom_smooth(method = "lm", se = FALSE)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_point(alpha = 0.008)+
geom_smooth(method = "lm", se = FALSE)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_smooth(method = "lm", se = FALSE)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_smooth(method = "lm")+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
glimpse(scl_rsp)
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = log(logQ_m3_div_s,10)) %>%
pairs(c(7:12))
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
pairs(c(7:12))
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
pairs(c(7:12))
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
pairs([,7:12])
ggpairs()
?ggpairs()
###############################################################################
# Scaling Analysis for Respiration Rates across the Yakima and Willamette River
# Basins
# DATA PREPARATION
###############################################################################
# RESPIRATION DATA
###############################################################################
#By : Francisco Guerrero
#Data source: SWAT-NEXXS Model simulations (By Kyongho Son)
#Loading packages:
# Run for the first time only
#install.packages(librarian)
#To run this code in macOS it is necessary to install XQuartz from
#www.xquartz.org
librarian::shelf(tidyverse)
set.seed(2703)
# Data:
#values
#Yakima River Basin (yrb)
yrb_lgc_o <- read.csv("assets/data/raw/220725_yrb_resp_vars_legacy.csv",
stringsAsFactors = TRUE) #Dataset used for the AGU poster with uncorrected cumulative values
#i.e. respiration rates were not normalized by watershed area)
yrb_spt_o <- read.csv("assets/data/raw/230110_yrb_spatial_camp.csv",
stringsAsFactors = TRUE) #Predicted respiration rates at field locations
yrb_rsp_o <- read.csv("assets/data/raw/230116_yrb_respt_vars.csv",
stringsAsFactors = TRUE) #Updated dataset with corrected cumulative values
yrb_hbc_o <- read.csv("assets/data/raw/230117_yrb_hbgc_vars.csv",
stringsAsFactors = TRUE) #Hydro-biogeochemical variables (including residence
#time and hyporheic exchange)
#Willamette River Basin (wlm)
wlm_rsp_o <- read.csv("assets/data/raw/cum_resp_WM_mass_data_0116_2023.csv",
stringsAsFactors = TRUE)
wlm_rsp_i <- read.csv("assets/data/raw/model_resp_wm_rf0116.csv", stringsAsFactors = TRUE)
wlm_hbc_o <- read.csv("assets/data/raw/nhd_WM_streamdatabase_annual_resp_mass_01162023.csv",
stringsAsFactors = TRUE)
wlm_hbc_i <- read.csv("assets/data/raw/model_resp_annual_wm_input_output_df_01_16_2023.csv",
stringsAsFactors = TRUE)
var_names <- colnames(yrb_rsp_o)
glimpse(wlm_rsp_o)
glimpse(wlm_rsp_i)
glimpse(wlm_hbc_o)
glimpse(wlm_hbc_i)
wlm_hbc_om <- dplyr::select(wlm_hbc_o,COMID,CAT_STREAM_SLOPE,TOT_STREAM_SLOPE,TOT_BASIN_AREA)
wlm_hbc_im <- dplyr::select(wlm_hbc_i,COMID,TotDASqKM,length_m)
wlm_rsp_om <- dplyr::select(wlm_rsp_o,COMID,FromNode,ToNode,cum_totco2g_day,cum_stream_area_m2,
cum_stream_length_m, cum_totco2g_day_Tdrain_m2, cum_totco2g_day_Tsurface_m2)
wlm_rsp_im <- dplyr::select(wlm_rsp_i,COMID,totco2g_day_fill,pred_stream_area_m2_fill,stream_length_m)
#Since merge only takes two inputs at a time, we have to merge our datasets sequentially
wlm_hbc_mg <- unique(merge(wlm_hbc_om,wlm_hbc_im,by = "COMID"))
wlm_rsp_mg <- unique(merge(wlm_rsp_om,wlm_rsp_im,by = "COMID"))
wlm_rsp_mg0 <- unique(merge(wlm_rsp_mg,wlm_hbc_mg,by="COMID"))
wlm_rsp_mg0$pred_logw_m <- log((wlm_rsp_mg0$pred_stream_area_m2_fill/wlm_rsp_mg0$stream_length_m),10)
yrb_rsp_m1 <- dplyr::select(yrb_rsp_o,
COMID,
FromNode,
ToNode,
TOT_BASIN_AREA,
stream_length_m,
pred_logw_m,
pred_stream_area_m2_fill,
cum_stream_length_m,
cum_stream_area_m2,
cum_totco2g_day,
cum_totco2g_day_Tsurface_m2,
cum_totco2g_day_Tdrain_m2)
wlm_rsp_m1 <- dplyr::select(wlm_rsp_mg0,
COMID,
FromNode,
ToNode,
TOT_BASIN_AREA,
stream_length_m,
pred_logw_m,
pred_stream_area_m2_fill,
cum_stream_length_m,
cum_stream_area_m2,
cum_totco2g_day,
cum_totco2g_day_Tsurface_m2,
cum_totco2g_day_Tdrain_m2)
yrb_rsp_m1$basin <- "Yakima"
wlm_rsp_m1$basin <- "Willamette"
yrb_hbc_m1 <- select(yrb_hbc_o,
COMID,
StreamOrde,
logQ_m3_div_s,
logwbkf_m,
logd_m,
logdbkf_m,
D50_m,
pred_annual_DOC,
pred_annual_DO,
no3_conc_mg_l,
logRT_total_hz_s,
logq_hz_total_m_s)
wlm_hbc_m1 <- select(wlm_hbc_i,
COMID,
StreamOrde,
logQ_m3_div_s,
logwbkf_m,
logd_m,
logdbkf_m,
D50_m,
pred_annual_DOC,
pred_annual_DO,
no3_conc_mg_l,
logRT_total_hz_s,
logq_hz_total_m_s)
yrb_rsp_m2 <- unique(merge(yrb_rsp_m1,yrb_hbc_m1,by = "COMID"))
wlm_rsp_m2 <- unique(merge(wlm_rsp_m1,wlm_hbc_m1,by = "COMID"))
scl_rsp <- rbind(yrb_rsp_m2,wlm_rsp_m2)
p0 <- ggplot(scl_rsp,aes(TOT_BASIN_AREA,cum_totco2g_day_Tdrain_m2,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
geom_abline(slope = 1, intercept =-3,linetype = "solid")+
geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)
p0
p1 <- ggplot(filter(scl_rsp, cum_totco2g_day_Tdrain_m2 > 0),
aes(TOT_BASIN_AREA,cum_totco2g_day_Tdrain_m2,color = basin))+
geom_point(alpha = 0.35)+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 0.5, intercept =-4.25,linetype = "dashed")+
geom_abline(slope = 1, intercept =-3,linetype = "solid")+
geom_abline(slope = 1.5, intercept =-1.75,linetype = "dashed")+
facet_wrap(~basin, ncol = 2)
p1
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
cum_stream_area_m2,
cum_stream_length_m) %>%
gather(key = "variable",value = "value",c(4:5),factor_key = TRUE) %>%
ggplot(aes(TOT_BASIN_AREA,value,color=variable))+
geom_smooth(method = "lm")+
scale_x_log10()+
scale_y_log10()+
geom_abline(slope = 1, intercept = 2.95, linetype = "dashed")+
facet_wrap(~basin,ncol = 2)
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 7:12)
librarian::shelf(tidyverse, GGally)
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 7:12)
?ggpairs()
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 7:12,
alpha(0.5),
color = gray)
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 7:12,
aes(fill = "gray", alpha = 0.5))
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 7:12,
aes(color = "gray",fill = "gray", alpha = 0.05))
scl_rsp %>% select(COMID,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 7:12,
aes(color = basin ,alpha = 0.05))
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 7:12,
aes(color = basin ,alpha = 0.05))
scl_rsp %>% select(COMID,
basin,
TOT_BASIN_AREA,
pred_stream_area_m2_fill,
StreamOrde,
logQ_m3_div_s,
D50_m,
logRT_total_hz_s,
logq_hz_total_m_s) %>%
mutate(logwsd_are = log(TOT_BASIN_AREA,10),
logstm_are = log(pred_stream_area_m2_fill,10),
logd50_m = log(D50_m,10),
logq_m3 = logQ_m3_div_s,10) %>%
ggpairs(columns = 8:12,
aes(color = basin ,alpha = 0.05))
